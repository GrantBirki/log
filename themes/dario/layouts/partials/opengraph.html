{{ $title := .Params.ogTitle | default .Title }}
{{ $description := .Params.ogDescription | default .Description | default .Site.Params.description | default .Summary | truncate 150 }}

{{ $uniqueName := "" }}
{{ with .File }}
  {{ $uniqueName = printf "og/og-image-%s.svg" .UniqueID }}
{{ else }}
  {{ $uniqueName = "og/og-image-default.svg" }}
{{ end }}

{{ $svg := printf `
    <svg xmlns="http://www.w3.org/2000/svg" width="1200" height="630" viewBox="0 0 1200 630">
        <style>
            @font-face {
              font-family: 'Newsreader';
              src: url('/fonts/Newsreader.woff2') format('woff2');
            }
            .title, .description {
              font-family: 'Newsreader', serif;
              fill: #141413;
              text-anchor: start;
              line-height: 1.1;
            }
        </style>
        <rect width="1200" height="630" fill="#f0efea" />
        <foreignObject x="80" y="200" width="840" height="300">
            <div xmlns="http://www.w3.org/1999/xhtml">
                <div style="font-family: Newsreader, serif; font-size: 78px; font-weight: 600; margin-bottom: 20px; word-wrap: break-word;">%s</div>
                <div style="font-family: Newsreader, serif; font-size: 70px; font-weight: 400; word-wrap: break-word;">%s</div>
            </div>
        </foreignObject>
    </svg>
    ` $title $description | safeHTML }}

{{ $generatedSVG := resources.FromString $uniqueName $svg | resources.ExecuteAsTemplate $uniqueName . }}

<!-- General Open Graph Meta Tags -->
<meta property="og:title" content="{{ $title }}" />
<meta property="og:description" content="{{ $description }}" />
<meta property="og:image" content="{{ $generatedSVG.Permalink }}" />
<meta property="og:image:type" content="image/svg+xml" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:type" content="website" />
<meta property="og:url" content="{{ .Permalink }}" />

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="{{ $title }}" />
<meta name="twitter:description" content="{{ $description }}" />
<meta name="twitter:image" content="{{ $generatedSVG.Permalink }}" />
